To copy important files to AWS, run the following commands from the blue-dot-robots-server root directory.
Locally, run `npm run build`

Staging:
	scp -i /Users/arieltamayev/Documents/bdr-staging-ec2-keypair.pem -r ./dist ubuntu@34.229.209.115:/home/ubuntu/blue-dot-robots
	scp -i /Users/arieltamayev/Documents/bdr-staging-ec2-keypair.pem -r ./prisma ubuntu@34.229.209.115:/home/ubuntu/blue-dot-robots/dist/src
	scp -i /Users/arieltamayev/Documents/bdr-staging-ec2-keypair.pem ./package.json ubuntu@34.229.209.115:/home/ubuntu/blue-dot-robots
	scp -i /Users/arieltamayev/Documents/bdr-staging-ec2-keypair.pem ./package-lock.json ubuntu@34.229.209.115:/home/ubuntu/blue-dot-robots
	scp -i /Users/arieltamayev/Documents/bdr-staging-ec2-keypair.pem ./.env.production ubuntu@34.229.209.115:/home/ubuntu/blue-dot-robots/dist/src/.env
	scp -i /Users/arieltamayev/Documents/bdr-staging-ec2-keypair.pem ./ecosystem.config.js ubuntu@34.229.209.115:/home/ubuntu/blue-dot-robots/dist/src

Production:
	scp -i /Users/arieltamayev/Documents/bdr-production-ec2.pem -r ./dist ubuntu@54.81.65.153:/home/ubuntu/blue-dot-robots
	scp -i /Users/arieltamayev/Documents/bdr-production-ec2.pem -r ./prisma ubuntu@54.81.65.153:/home/ubuntu/blue-dot-robots/dist/src
	scp -i /Users/arieltamayev/Documents/bdr-production-ec2.pem ./package.json ubuntu@54.81.65.153:/home/ubuntu/blue-dot-robots
	scp -i /Users/arieltamayev/Documents/bdr-production-ec2.pem ./package-lock.json ubuntu@54.81.65.153:/home/ubuntu/blue-dot-robots
	scp -i /Users/arieltamayev/Documents/bdr-production-ec2.pem ./.env.production ubuntu@54.81.65.153:/home/ubuntu/blue-dot-robots/dist/src/.env
	scp -i /Users/arieltamayev/Documents/bdr-production-ec2.pem ./ecosystem.config.js ubuntu@54.81.65.153:/home/ubuntu/blue-dot-robots/dist/src

To SSH into AWS:
	Staging:
		aws ec2-instance-connect ssh --instance-id i-0151f137cb9067c1c --os-user ubuntu
	Prod:
		aws ec2-instance-connect ssh --instance-id i-0af414ad7e5d89c3e --os-user ubuntu

In AWS:
`cd blue-dot-robots`
`npm install --production`
`pm2 restart <app_name or app_id>`

For Database migrations, navigate to dist/src, and run::
	`npx prisma migrate deploy`
	Run `npx prisma generate` in the src directory.
	`pm2 restart <app_name or app_id>`
	If nothing is working after doing a migration, try restarting the pm2 `pm2 restart <app_name or app_id>`

I am using the package pm2 to run the server on the instance (even after I close my connection)
Important pm2 commands:
1. pm2 list (shows pm2 instances)
2. pm2 stop app_name_or_id (stops a running pm2 process)
3. pm2 delete app_name_or_id (deletes a stopped pm2 process)
4.
	Staging: pm2 start ecosystem.config.js --env staging (must be done where the index.js file is)
	Production: pm2 start ecosystem.config.js --env production (must be done where the index.js file is)
5. pm2 logs app_name_or_id (shows logs for a process)

Other:
- If getting this error:  `Error: @prisma/client did not initialize yet. Please run "prisma generate" and try to import it again.`, run:
	`npx prisma generate` in the src directory
- If getting this error after a migration: `Unknown field `[field_name]` for select statement on model [model_name]...`
	Check that the field exists in PGAdmin (remote into the RDS box). If it does, run `npx prisma generate` in the src directory
- To save the Postgres Url to AWS's configuration, go into `nano ~/.bashrc`, to the end of the file, and add:
	export DATABASE_URL='your-database-url'.
	Save, and run `source ~/.bashrc`
	Run `echo $DATABASE_URL` to make sure the command ran correctly

- Update linux packages
	sudo apt update && sudo apt upgrade -y && sudo apt autoremove -y

To get into the Docker container inside the instance:
	Run: `sudo docker ps`
	`sudo docker exec -it <container_id> /bin/bash`

To get into DB:
	For Staging, access via PGAdmin
	For production:
		run: `ssh -i /Users/arieltamayev/Documents/bdr-production-ec2.pem -L 5433:new-bdr-prod-db.c18kkyek274l.us-east-1.rds.amazonaws.com:5432 ubuntu@54.81.65.153`
		While that is open in one terminal, run: `psql -h localhost -p 5433 -U postgres -d bluedotrobots` in another

Periodically locally run `depcheck` to see if any packages aren't being used
