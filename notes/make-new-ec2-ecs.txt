Make sure to choose the AWS ECS image (Image creation takes about 10 mins)

1. Create a new ECS cluster
2. Create an EC2 Instance 
	T3 medium
	subnet ending in A7 (to allow for instance connect)
	security-group-1
	ECS instance role in the IAM instance profile
	Add this to user data:
		#!/bin/bash

		# Create directories for ECS container mounts
		mkdir -p /ecs/pio-cache
		mkdir -p /ecs/workspace
		chmod 777 /ecs/pio-cache
		chmod 777 /ecs/workspace

		# Install and configure CloudWatch agent if not already in AMI
		yum install -y amazon-cloudwatch-agent
		/opt/aws/amazon-cloudwatch-agent/bin/amazon-cloudwatch-agent-ctl -a fetch-config -m ec2 -s -c ssm:/AmazonCloudWatch/ECSCloudWatchConfig

		# Update ECS config to enable container insights and set cluster name
		echo "ECS_CLUSTER=	" >> /etc/ecs/ecs.config
		echo "ECS_ENABLE_CONTAINER_METADATA=true" >> /etc/ecs/ecs.config
		echo "ECS_ENABLE_AWSLOGS_EXECUTIONROLE_OVERRIDE=true" >> /etc/ecs/ecs.config

		# Set Docker daemon options for better logging and performance
		cat << EOF > /etc/docker/daemon.json
		{
			"log-driver": "awslogs",
			"log-opts": {
				"awslogs-region": "us-east-1",
				"awslogs-group": "/ecs/production-firmware-compiler-ec2",
				"awslogs-stream-prefix": "ecs"
			},
			"storage-driver": "overlay2",
			"storage-opts": ["overlay2.override_kernel_check=true"]
		}
		EOF

		# Restart Docker to apply changes
		systemctl restart docker

		# Start ECS agent
		systemctl enable --now ecs

	After making a new EC2 ECS instance, need to add it to the ECS cluster via the ECS console (run inside the box after ssh-ing into it):
		`sudo amazon-linux-extras install -y ecs
		sudo systemctl enable ecs
		sudo systemctl start ecs`

		`sudo bash -c 'cat << EOF > /etc/ecs/ecs.config
	ECS_CLUSTER=bdr-production-ecs-ec2-cluster
	ECS_ENABLE_TASK_IAM_ROLE=true
	ECS_ENABLE_TASK_IAM_ROLE_NETWORK_HOST=true
	EOF'`

		sudo mkdir -p /ecs/pio-cache
		sudo mkdir -p /ecs/workspace
		sudo chmod 777 /ecs/pio-cache
		sudo chmod 777 /ecs/workspace

		sudo yum install -y docker
		sudo systemctl enable docker
		sudo systemctl start docker

	aws ecs list-container-instances --cluster bdr-staging-ecs-ec2-cluster

The instance/task should auto-appear in the cluster

3. Register task defintion
